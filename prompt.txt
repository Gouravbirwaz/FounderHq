Build a microservice named “huddle-service” inside a new folder called:

/huddle-feature

This must be completely independent from the main server and deployed separately. It must communicate with the main application only via REST API or token-based authentication.

This is a real-time communication microservice built using:

Backend:

Node.js

Express

Socket.io (for signaling)

WebRTC (peer connection handling)

MongoDB (shared cluster allowed)

JWT-based authentication

Frontend:

React (or integrate via iframe/component in main UI)

WebRTC browser APIs

Clean Discord-style UI

Architecture Requirements:

Microservice Isolation

Runs on separate port (e.g., 5001)

Has its own package.json

Has its own Dockerfile

Deployable independently

Must not depend on main server runtime

Can validate JWT issued by main server

Database

Use MongoDB

Collections:

huddle_rooms

huddle_participants

huddle_activity_logs

Room Schema:
{
roomId: string,
createdBy: userId,
type: "voice" | "video",
participants: [userId],
createdAt: timestamp,
status: "active" | "ended"
}

Features

Feature 1 — Voice Huddle

Audio-only WebRTC

No video tracks

Mute/unmute support

Join/leave room

Real-time participant list

Feature 2 — Video + Audio Huddle

Camera on/off

Mute/unmute

Dynamic grid layout

Max 8 participants

ICE negotiation handling

Proper cleanup on disconnect

Signaling Server

Use Socket.io for:

join-room

offer

answer

ice-candidate

leave-room

Implement:

Room-based socket grouping

User authentication via JWT

Cleanup on disconnect

WebRTC Flow

Frontend:

getUserMedia()

Create RTCPeerConnection

Exchange SDP via signaling

Add tracks dynamically

Handle remote streams

Support:

STUN server (Google public STUN)

Optional TURN support placeholder

Security

Require valid JWT token

Validate token on socket connection

Only authenticated users can create/join rooms

Prevent users from joining rooms they are not invited to (optional access list)

Business Purpose Logic

Why this feature exists:

Investors and interested users can discuss projects inside platform

No sharing of personal contact information

All communication remains platform-contained

Temporary rooms auto-expire after inactivity (30 minutes)

REST Endpoints

POST /rooms/create
GET /rooms/:id
POST /rooms/:id/join
POST /rooms/:id/end

Sidebar Integration

In the main UI:

Add “Huddle” item in sidebar

Clicking opens Huddle panel

Show:

Create Voice Huddle

Create Video Huddle

Active Rooms

Clicking a room loads WebRTC UI component

UI Requirements

Discord-like minimal UI:

Left panel: Room list

Main panel: Video grid or voice UI

Bottom controls:

Mic toggle

Camera toggle (video mode only)

Leave button

Microservice Deployment

Dockerized

Exposes port 5001

Environment variables:

MONGO_URI

JWT_SECRET

STUN_SERVER

No dependency on main server runtime

Scalability Notes

For now:

Peer-to-peer WebRTC

Future-ready:

Placeholder for SFU integration

Scalable signaling architecture

Horizontal scaling ready (sticky sessions required)

Now let’s talk real engineering.

If you build pure peer-to-peer:

1:1 = perfect

4 users = manageable

8 users = borderline

12+ = chaos

Discord uses SFU architecture.
If your platform grows, you’ll eventually migrate to:

mediasoup

LiveKit

Janus

But for MVP, P2P is fine.